pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

t=0

local rspr_clear_col=14

function _update()

 t+=1
 
 if t==31 then
  t=0
 end

end

function _draw()
 cls(1)

 --[[rotate half the sprite
  from 0,0,
 draw to sprite sheet pos
  8,8,
  rotation from 0-1,
  size to draw in tiles
 ]]
 rspr(0,0,8,8,t/30,0.5)
 
 --now draw sprite at the loc
 -- we just drew to
 sspr(8,8,8,8,50,50)
end

--[[taken from
https://www.lexaloffle.com/bbs/?tid=3593
]]
function rspr(sx,sy,x,y,a,w)
	local ca,sa=cos(a),sin(a)
	local srcx,srcy,addr,pixel_pair
	local ddx0,ddy0=ca,sa
	local mask=shl(0xfff8,(w-1))
	w*=4
	ca*=w-0.5
	sa*=w-0.5
	local dx0,dy0=sa-ca+w,-ca-sa+w
	w=2*w-1
	for ix=0,w do
		srcx,srcy=dx0,dy0
		for iy=0,w do
			if band(bor(srcx,srcy),mask)==0 then
				local c=sget(sx+srcx,sy+srcy)
				sset(x+ix,y+iy,c)
			else
				sset(x+ix,y+iy,rspr_clear_col)
			end
			srcx-=ddy0
			srcy+=ddx0
		end
		dx0+=ddx0
		dy0+=ddy0
	end
end

__gfx__
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55888855000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
58555585000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555588000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55558885000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55588555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
58855555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
58888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
